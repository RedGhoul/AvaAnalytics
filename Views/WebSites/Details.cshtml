@model SharpCounter.Enities.WebSites

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>WebSites</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.APIKey)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.APIKey)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.LinkDomain)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.LinkDomain)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.CreatedAt)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.CreatedAt)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.UpdatedAt)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.UpdatedAt)
        </dd>
    </dl>
</div>
<div>
    <canvas id="bar-chart-horizontal" width="800" height="450"></canvas>
</div>
<div>
    <a asp-action="Edit" asp-route-id="@Model.Id">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>
@section Scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" integrity="sha256-R4pqcOYV8lt7snxMQO/HSbVCFRPMdrhAFMH+vr9giYI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"
            integrity="sha256-T/f7Sju1ZfNNfBh7skWn0idlCBcI3RwdLSS4/I7NQKQ=" crossorigin="anonymous"></script>
    <script>
        let labels = [];
        let nums = [];
        axios.get('/api/BrowserStats')
            .then(function (response) {
                let data = response.data;
                console.log(data)
                data.forEach(stat => {
                    labels.push(stat.browser + " " + stat.version);
                    nums.push(stat.count);
                });
            })
            .catch(function (error) {
                console.log(error);
            })
            .then(function () {
                new Chart(document.getElementById("bar-chart-horizontal"), {
                    type: 'horizontalBar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: "Couts",
                                backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                                data: nums
                            }
                        ]
                    },
                    options: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'Browser Stats for the last 30 mins'
                        }
                    }
                });
            });

    </script>
}