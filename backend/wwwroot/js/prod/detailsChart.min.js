$(function(){var a={webSiteId:document.querySelector("script[data-website-id]").getAttribute("data-website-id"),PageViewCountChartNode:document.getElementById("bar-chart-PageViewCounts"),URLRoutesVisitedChartNode:document.getElementById("bar-chart-InteractionStats"),BrowserTypeStatsChartNode:document.getElementById("bar-chart-BrowserStats"),SystemStatsChartNode:document.getElementById("bar-chart-SystemStats"),ScreenSizeStatsChartNode:document.getElementById("bar-chart-ScreenStats"),LocationOfVisitorsStatsChartNode:document.getElementById("bar-chart-LocationStats"),newGradArr:["#CC2936","#08415C"],InteractionStats_NotFoundText:document.getElementById("InteractionStats-NotFoundText"),BrowserStats_NotFoundText:document.getElementById("BrowserStats-NotFoundText"),SystemStats_NotFoundText:document.getElementById("SystemStats-NotFoundText"),ScreenStats_NotFoundText:document.getElementById("ScreenStats-NotFoundText"),LocationStats_NotFoundText:document.getElementById("LocationStats-NotFoundText"),Error_Message:"Nothing Found Just Yet",StatsSerachBtn:document.getElementById("StatsSerach"),CurrentStartDate:null,CurrentEndDate:null,baseDateTime:null,Chart_PageViewStats:null,Chart_InteractionStats:null,Chart_BrowserStats:null,Chart_SystemStats:null,Chart_ScreenSizeStats:null,Chart_LocationStats:null,Set_BaseDate:function(){a.CurrentStartDate=moment().subtract(7,"days").format(),a.CurrentEndDate=moment().format(),a.baseDateTime={CurrentStartDate:a.CurrentStartDate,CurrentEndDate:a.CurrentEndDate}},Hid_NotFoundText:function(){a.InteractionStats_NotFoundText.hidden=!0,a.BrowserStats_NotFoundText.hidden=!0,a.SystemStats_NotFoundText.hidden=!0,a.ScreenStats_NotFoundText.hidden=!0,a.LocationStats_NotFoundText.hidden=!0},Display_Error_Message:function(a,b,c){null!==a&&0!==a.length||(b.innerHTML=c,b.hidden=!1),sum=0;for(var d=0;d<a.length;d++)sum+=a[d];0===sum&&(b.innerHTML=c,b.hidden=!1)},GetDeviceType:function(){var a=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(a)?"tablet":/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(a)?"mobile":"desktop"},Refresh_Chart_UI:function(b,c,d,e,f){axios({method:b,url:c,data:d,headers:a.headers}).then(function(a){var b=a.data,c=[],d=[];b.forEach(function(a){c.push(moment(a.createdAt).local().format("YYYY-MM-DD HH:mm:ss")),d.push(a.count)}),e.data=f(d,c),e.update()})},SetUp_DateTimePickers:function(){jQuery.datetimepicker.setLocale("en"),$("#date_timepicker_start").datetimepicker({format:"Y/m/d",onShow:function(a){this.setOptions({maxDate:!!$("#date_timepicker_end").val()&&jQuery("#date_timepicker_end").val()})},timepicker:!1,onChangeDateTime:function(b,c){a.CurrentStartDate=moment(c.val()).format()}}),$("#date_timepicker_end").datetimepicker({format:"Y/m/d",onShow:function(a){this.setOptions({minDate:!!$("#date_timepicker_start").val()&&jQuery("#date_timepicker_start").val()})},timepicker:!1,onChangeDateTime:function(b,c){a.CurrentEndDate=moment(c.val()).add(1,"days").format()}})},SetUp_DateTime_Event_Listeners:function(){a.StatsSerachBtn.addEventListener("click",function(b){b.preventDefault();for(var c="post",d=function(a,b){return{labels:b,datasets:[{borderColor:"rgb(255, 99, 132)",label:"Counts",data:a}],fill:!1}},e=function(b,c){return{labels:c,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(b.length),data:b}]}},f=[{chart:a.Chart_PageViewStats,data_function:d,chart_url:"/api/Stats/PageViewCountStats/"+a.webSiteId},{chart:a.Chart_InteractionStats,data_function:e,chart_url:"/api/Stats/InteractionStats/"+a.webSiteId},{chart:a.Chart_BrowserStats,data_function:e,chart_url:"/api/Stats/BrowserStats/"+a.webSiteId},{chart:a.Chart_SystemStats,data_function:e,chart_url:"/api/Stats/SystemStats/"+a.webSiteId},{chart:a.Chart_ScreenSizeStats,data_function:e,chart_url:"/api/Stats/ScreenSizeStats/"+a.webSiteId},{chart:a.Chart_LocationStats,data_function:e,chart_url:"/api/Stats/LocationStats/"+a.webSiteId}],g={CurrentStartDate:a.CurrentStartDate,CurrentEndDate:a.CurrentEndDate},h=0;h<f.length;h++)a.Refresh_Chart_UI(c,f[h].chart_url,g,f[h].chart,f[h].data_function)})},headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"}};a.Set_BaseDate(),a.Hid_NotFoundText(),a.SetUp_DateTimePickers(),a.SetUp_DateTime_Event_Listeners();var b={yAxes:[{ticks:{beginAtZero:!0,fontSize:14,fontFamily:"'Roboto', sans-serif",fontColor:"black",fontStyle:"500"}}],xAxes:[{ticks:{beginAtZero:!0,stepSize:10,fontSize:14,fontFamily:"'Roboto', sans-serif",fontColor:"black",fontStyle:"500"}}]},c={yAxes:[{ticks:{beginAtZero:!0,fontSize:14,fontFamily:"'Roboto', sans-serif",fontColor:"black",fontStyle:"500"}}],xAxes:[{ticks:{beginAtZero:!0,stepSize:10,fontSize:12,fontFamily:"'Roboto', sans-serif",fontColor:"black",fontStyle:"500",autoSkip:!1,maxRotation:90,minRotation:90}}]},d={fontSize:14,fontColor:"black",display:!0};"mobile"===a.GetDeviceType()&&(ISChart.height=80,BSChart.height=40,SysSChart.height=40,ScreenSChart.height=40,LocationSChart.height=40),axios({method:"post",url:"/api/Stats/PageViewCountStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(b){var e=b.data,f=[],g=[];e.forEach(function(a){f.push(moment(a.createdAt).local().format("YYYY-MM-DD HH:mm:ss")),g.push(a.count)}),a.Chart_PageViewStats=new Chart(a.PageViewCountChartNode,{type:"line",data:{labels:f,datasets:[{borderColor:"rgb(255, 99, 132)",label:"Counts",data:g}],fill:!1},options:{legend:{display:!1},title:{fontSize:18,fontColor:d.fontColor,display:d.display,text:"Page View Counts"},scales:c}})}).catch(function(a){console.log(a)}),axios({method:"post",url:"/api/Stats/InteractionStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(c){var e=c.data,f=[],g=[];a.Display_Error_Message(e,a.InteractionStats_NotFoundText,a.Error_Message),e.forEach(function(a){f.push(a.path),g.push(a.total)}),a.Chart_InteractionStats=new Chart(a.URLRoutesVisitedChartNode,{type:"horizontalBar",data:{labels:f,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(g.length),data:g}]},options:{legend:{display:!1},title:{fontSize:18,fontColor:d.fontColor,display:d.display,text:"Page Interactions"},scales:b}})}).catch(function(a){console.log(a)}),axios({method:"post",url:"/api/Stats/BrowserStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(c){var e=c.data;a.Display_Error_Message(e,a.BrowserStats_NotFoundText,a.Error_Message);var f=[],g=[];e.forEach(function(a){f.push(a.browser+" "+a.version),g.push(a.count)}),a.Chart_BrowserStats=new Chart(a.BrowserTypeStatsChartNode,{type:"horizontalBar",data:{labels:f,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(g.length),data:g}]},options:{legend:{display:!1},title:{fontSize:d.fontSize,fontColor:d.fontColor,display:d.display,text:"Browser Stats"},scales:b}})}).catch(function(a){console.log(a)}),axios({method:"post",url:"/api/Stats/SystemStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(c){var e=c.data;a.Display_Error_Message(e,a.SystemStats_NotFoundText,a.Error_Message);var f=[],g=[];e.forEach(function(a){f.push(a.platform+" "+a.version),g.push(a.count)}),a.Chart_SystemStats=new Chart(a.SystemStatsChartNode,{type:"horizontalBar",data:{labels:f,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(g.length),data:g}]},options:{legend:{display:!1},title:{fontSize:d.fontSize,fontColor:d.fontColor,display:d.display,text:"System Stats"},scales:b}})}).catch(function(a){console.log(a)}),axios({method:"post",url:"/api/Stats/ScreenSizeStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(c){var e=c.data,f=["Phones","Large Phones","Tables","Desktops","Monitors 4K Plus"],g={numberOfPhones:"Phones",largePhonesSmallTablets:"Large Phones",tabletsSmallLaptops:"Tables",computerMonitors:"Desktops",computerMonitors4K:"Monitors 4K Plus"},h=[];for(var i in e[0])for(var j in f)g[i]===f[j]&&h.push(e[0][i]);console.log(h),a.Display_Error_Message(h,a.ScreenStats_NotFoundText,a.Error_Message),a.Chart_ScreenSizeStats=new Chart(a.ScreenSizeStatsChartNode,{type:"horizontalBar",data:{labels:f,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(h.length),data:h}]},options:{legend:{display:!1},title:{fontSize:d.fontSize,fontColor:d.fontColor,display:d.display,text:"Screen Size Stats"},scales:b}})}).catch(function(a){console.log(a)}),axios({method:"post",url:"/api/Stats/LocationStats/"+a.webSiteId,data:a.baseDateTime,headers:a.headers}).then(function(c){var e=c.data;a.Display_Error_Message(e,a.LocationStats_NotFoundText,a.Error_Message);var f=[],g=[];e.forEach(function(a){f.push(a.location),g.push(a.count)}),a.Chart_LocationStats=new Chart(a.LocationOfVisitorsStatsChartNode,{type:"horizontalBar",data:{labels:f,datasets:[{label:"Counts",backgroundColor:chroma.scale(a.newGradArr).mode("lch").colors(g.length),data:g}]},options:{legend:{display:!1},title:{fontSize:d.fontSize,fontColor:d.fontColor,display:d.display,text:"Location Stats"},scales:b}})}).catch(function(a){console.log(a)})});